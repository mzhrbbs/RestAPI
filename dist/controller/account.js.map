{"version":3,"sources":["../../src/controller/account.js"],"names":["config","db","api","post","req","res","register","username","body","email","password","err","account","send","authenticate","session","status","scope","get","logout","json","user"],"mappings":";;;;;;AAAA;;;;AACA;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;AAEA;;;;kBAEe,gBAAiB;AAAA,MAAfA,MAAe,QAAfA,MAAe;AAAA,MAARC,EAAQ,QAARA,EAAQ;;AAC9B,MAAIC,MAAM,sBAAV;;AAEF;;AAEA;AACEA,MAAIC,IAAJ,CAAS,WAAT,EAAsB,UAACC,GAAD,EAAKC,GAAL,EAAa;AACjC,sBAAQC,QAAR,CAAiB,sBAAY,EAAEC,UAAUH,IAAII,IAAJ,CAASC,KAArB,EAAZ,CAAjB,EAA4DL,IAAII,IAAJ,CAASE,QAArE,EAA+E,UAACC,GAAD,EAAKC,OAAL,EAAiB;AAC9F,UAAID,GAAJ,EAAQ;AACNN,YAAIQ,IAAJ,CAASF,GAAT;AACD;;AAED,yBAASG,YAAT,CACE,OADF,EACW;AACPC,iBAAS;AADF,OADX,EAGMX,GAHN,EAGUC,GAHV,EAGe,YAAM;AACjBA,YAAIW,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB,kCAArB;AACD,OALH;AAMC,KAXH;AAYC,GAbH;;AAeF;AACEX,MAAIC,IAAJ,CAAS,QAAT,EAAmB,mBAASW,YAAT,CACjB,OADiB,EACR;AACPC,aAAQ,KADD;AAEPE,WAAO;AAFA,GADQ,CAAnB;;AAOF;AACEf,MAAIgB,GAAJ,CAAQ,SAAR,gCAAiC,UAACd,GAAD,EAAKC,GAAL,EAAa;AAC5CA,QAAIc,MAAJ;AACAd,QAAIW,MAAJ,CAAW,GAAX,EAAgBH,IAAhB,CAAqB,yBAArB;AACD,GAHD;;AAKF;AACIX,MAAIgB,GAAJ,CAAQ,KAAR,gCAA6B,UAACd,GAAD,EAAKC,GAAL,EAAa;AACxCA,QAAIW,MAAJ,CAAW,GAAX,EAAgBI,IAAhB,CAAqBhB,IAAIiB,IAAzB;AACD,GAFD;;AAIA,SAAOnB,GAAP;AACH,C","file":"account.js","sourcesContent":["import mongoose from 'mongoose';\nimport {Router} from 'express';\nimport Account from '../models/account';\nimport bodyParser from 'body-parser'\nimport passport from 'passport';\nimport config from '../config';\n\nimport {generateAccessToken, respond, authenticate } from '../middleware/authMiddleware';\n\nexport default ({config,db}) => {\n  let api = Router();\n\n//Lets define out routes\n\n// '/v1/account/register'\n  api.post('/register', (req,res) => {\n    Account.register(new Account({ username: req.body.email }), req.body.password, (err,account) => {\n      if (err){\n        res.send(err);\n      }\n\n      passport.authenticate(\n        'local', {\n          session: false\n        }) (req,res, () => {\n          res.status(200).send('Successfully created new Account');\n        });\n      });\n    });\n\n// 'v1/account/login'\n  api.post('/login', passport.authenticate (\n    'local', {\n      session:false,\n      scope: []\n    }), generateAccessToken, respond);\n\n\n//'v1/account/logout'\n  api.get('/logout', authenticate, (req,res) => {\n    res.logout();\n    res.status(200).send('Successfully logged out');\n  });\n\n//v1/account/me\n    api.get('/me', authenticate, (req,res) => {\n      res.status(200).json(req.user);\n    });\n\n    return api;\n}\n"]}